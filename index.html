<!DOCTYPE html>
<html lang="ur">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>8D Quran App</title>
    
    <!-- PWA Manifest Link -->
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#0d121a">

    <!-- Fonts and Icons -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Amiri:wght@700&family=Noto+Nastaliq+Urdu:wght@700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" rel="stylesheet" />

    <style>
        :root {
            --glow-color1: #0ebeff;
            --glow-color2: #ffdd40;
            --glow-color3: #ff4971;
            --glow-color4: #25d366;
            --highlight-glow: #f39c12;
            --background-color: #0d121a;
            --text-color: #ecf0f1;
            --menu-box-shadow: rgba(0,0,0,0.3);
            --ayah-box-shadow: rgba(0, 0, 0, 0.3);
        }

        /* تھیمز کی CSS */
        body.theme-default {
            --glow-color1: #0ebeff;
            --glow-color2: #ffdd40;
            --glow-color3: #ff4971;
            --glow-color4: #25d366;
            --highlight-glow: #f39c12;
            --background-color: #0d121a;
            --text-color: #ecf0f1;
        }

        body.theme-midnight-blue {
            --glow-color1: #1e3a8a;
            --glow-color2: #60a5fa;
            --glow-color3: #1e90ff;
            --glow-color4: #0284c7;
            --highlight-glow: #3b82f6;
            --background-color: #0f172a;
            --text-color: #dbeafe;
        }

        body.theme-emerald-glow {
            --glow-color1: #10b981;
            --glow-color2: #6ee7b7;
            --glow-color3: #34d399;
            --glow-color4: #059669;
            --highlight-glow: #4ade80;
            --background-color: #022c22;
            --text-color: #d1fae5;
        }

        body.theme-crimson-dawn {
            --glow-color1: #dc2626;
            --glow-color2: #f87171;
            --glow-color3: #ef4444;
            --glow-color4: #b91c1c;
            --highlight-glow: #f43f5e;
            --background-color: #1c1917;
            --text-color: #fee2e2;
        }

        body.theme-golden-sunset {
            --glow-color1: #d97706;
            --glow-color2: #facc15;
            --glow-color3: #f59e0b;
            --glow-color4: #b45309;
            --highlight-glow: #eab308;
            --background-color: #292524;
            --text-color: #fef3c7;
        }

        body.theme-amethyst-night {
            --glow-color1: #7c3aed;
            --glow-color2: #a78bfa;
            --glow-color3: #8b5cf6;
            --glow-color4: #6d28d9;
            --highlight-glow: #a855f7;
            --background-color: #1e1b4b;
            --text-color: #ede9fe;
        }

        body.theme-royal-purple {
            --glow-color1: #6b21a8;
            --glow-color2: #c084fc;
            --glow-color3: #9333ea;
            --glow-color4: #4c1d95;
            --highlight-glow: #a855f7;
            --background-color: #191524;
            --text-color: #e9d5ff;
        }

        body.theme-ocean-breeze {
            --glow-color1: #06b6d4;
            --glow-color2: #22d3ee;
            --glow-color3: #0891b2;
            --glow-color4: #0e7490;
            --highlight-glow: #22d3ee;
            --background-color: #0f2a44;
            --text-color: #cffafe;
        }

        body.theme-forest-dusk {
            --glow-color1: #15803d;
            --glow-color2: #34d399;
            --glow-color3: #16a34a;
            --glow-color4: #166534;
            --highlight-glow: #22c55e;
            --background-color: #1a2e05;
            --text-color: #dcfce7;
        }

        body.theme-rose-blush {
            --glow-color1: #e11d48;
            --glow-color2: #fb7185;
            --glow-color3: #f43f5e;
            --glow-color4: #be123c;
            --highlight-glow: #f472b6;
            --background-color: #2f1b25;
            --text-color: #fce7f3;
        }

        body.theme-silver-moon {
            --glow-color1: #94a3b8;
            --glow-color2: #e2e8f0;
            --glow-color3: #cbd5e1;
            --glow-color4: #64748b;
            --highlight-glow: #d1d5db;
            --background-color: #1e293b;
            --text-color: #f1f5f9;
        }

        html {
            scroll-behavior: smooth;
        }

        body {
            font-family: 'Amiri', serif;
            background-color: var(--background-color);
            background-image: radial-gradient(circle at 1px 1px, rgba(255,255,255,0.1) 1px, transparent 0);
            background-size: 25px 25px;
            animation: background-pan 50s linear infinite;
            margin: 0;
            padding: 20px;
            direction: rtl;
            overflow-x: hidden;
            color: var(--text-color);
        }

        @keyframes background-pan {
            from { background-position: 0% 0%; }
            to { background-position: 100% 100%; }
        }

        #homeScreen {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 90vh;
            text-align: center;
        }

        .aura-container {
            position: relative;
            padding: 30px;
            margin-bottom: 30px;
        }

        .aura-container::before,
        .aura-container::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            border-radius: 30px;
            z-index: -1;
            filter: blur(30px);
            animation: aura-pulse 6s ease-in-out infinite;
        }

        .aura-container::before {
            background: linear-gradient(45deg, var(--glow-color1), var(--glow-color2));
        }

        .aura-container::after {
            background: linear-gradient(-45deg, var(--glow-color3), var(--glow-color4));
            animation-delay: -3s;
        }

        @keyframes aura-pulse {
            0%, 100% { opacity: 0.6; transform: scale(0.95); }
            50% { opacity: 1; transform: scale(1.05); }
        }

        .home-header {
            color: var(--text-color);
            font-family: 'Noto Nastaliq Urdu', sans-serif;
        }

        .home-header h2 {
            font-size: 2.5rem;
            opacity: 0.9;
            letter-spacing: 2px;
            text-shadow: 0 0 15px rgba(236, 240, 241, 0.4);
        }

        .typing-container {
            padding: 10px;
            border-bottom: 2px solid rgba(243, 156, 18, 0.5);
            display: inline-block;
        }

        #bismillah-text {
            font-family: 'Amiri', serif;
            font-size: 3rem;
            color: var(--highlight-glow);
            font-weight: 700;
            text-shadow: 0 0 5px var(--highlight-glow), 0 0 15px var(--highlight-glow), 0 0 30px var(--highlight-glow);
            width: 0;
            white-space: nowrap;
            overflow: hidden;
            animation: bismillah_typing 8s steps(29, end) infinite;
        }

        @keyframes bismillah_typing {
            0% { width: 0; }
            50% { width: 100%; }
            80% { width: 100%; }
            100% { width: 0; }
        }

        .menu-container {
            width: 100%;
            max-width: 1200px;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 25px;
            font-family: 'Noto Nastaliq Urdu', sans-serif;
            margin-top: 50px;
        }

        .menu-box {
            padding: 35px;
            border-radius: 20px;
            cursor: pointer;
            box-shadow: inset 0 -5px 15px var(--menu-box-shadow), 0 5px 15px var(--menu-box-shadow);
            border: 1px solid rgba(255, 255, 255, 0.1);
            position: relative;
            animation: float-animation 6s ease-in-out infinite;
            transition: transform 0.3s ease;
        }

        .menu-box:hover {
            animation-play-state: paused;
            transform: translateY(-10px) scale(1.05) !important;
        }

        .menu-title {
            color: var(--text-color);
            font-size: 2.2rem;
            font-weight: 700;
            text-shadow: 0 0 3px rgba(0,0,0,0.8), 0 2px 5px rgba(0,0,0,0.7);
            white-space: nowrap;
            overflow: hidden;
            margin: 0 auto;
            display: inline-block;
        }

        .menu-box-1 { background: linear-gradient(145deg, var(--glow-color1), var(--glow-color2)); }
        .menu-box-2 { background: linear-gradient(145deg, var(--glow-color2), var(--glow-color3)); }
        .menu-box-3 { background: linear-gradient(145deg, var(--glow-color3), var(--glow-color4)); }
        .menu-box-4 { background: linear-gradient(145deg, var(--glow-color4), var(--glow-color1)); }
        .menu-box-5 { background: linear-gradient(145deg, var(--highlight-glow), var(--glow-color2)); }
        .menu-box-6 { background: linear-gradient(145deg, var(--glow-color1), var(--glow-color3)); }
        .menu-box-7 { background: linear-gradient(145deg, var(--glow-color2), var(--glow-color4)); }
        .menu-box-8 { background: linear-gradient(145deg, var(--glow-color3), var(--highlight-glow)); }

        .menu-title {
            animation: typing-short 7s steps(10, end) infinite;
        }

        @keyframes typing-short {
            0% { width: 0; }
            45% { width: 100%; }
            80% { width: 100%; }
            100% { width: 0; }
        }

        .surah-page {
            display: none;
            padding-top: 70px;
        }

        .header {
            text-align: center;
            margin-bottom: 20px;
        }

        .header h1 {
            font-size: 3.5rem;
            color: var(--text-color);
            text-shadow: 0px 2px 5px rgba(0,0,0,0.5);
            font-weight: 700;
        }

        .surah-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 30px;
            perspective: 1500px;
            padding-top: 20px;
        }

        @keyframes box-color-change {
            0%, 100% { background: linear-gradient(145deg, var(--glow-color1), var(--glow-color2)); }
            16.6% { background: linear-gradient(145deg, var(--glow-color2), var(--glow-color3)); }
            33.3% { background: linear-gradient(145deg, var(--glow-color3), var(--glow-color4)); }
            50% { background: linear-gradient(145deg, var(--glow-color4), var(--glow-color1)); }
            66.6% { background: linear-gradient(145deg, var(--highlight-glow), var(--glow-color2)); }
            83.3% { background: linear-gradient(145deg, var(--glow-color1), var(--glow-color3)); }
        }

        .ayah-box {
            padding: 40px 30px;
            border-radius: 20px;
            color: var(--text-color);
            box-shadow: 0 15px 30px var(--ayah-box-shadow);
            border: 1px solid rgba(255,255,255,0.1);
            display: flex;
            align-items: center;
            justify-content: center;
            opacity: 0;
            transform: translateY(40px);
            transition: opacity 0.6s ease-out, transform 0.6s ease-out, background 0.5s ease, box-shadow 0.5s ease;
            animation: box-color-change 18s linear infinite;
        }

        .ayah-box.visible {
            opacity: 1;
            transform: translateY(0);
        }

        .ayah-text {
            font-size: 2.2rem;
            line-height: 2.9;
            text-align: center;
            font-weight: 700;
            text-shadow: 0px 1px 1px rgba(0, 0, 0, 0.2), 0px 2px 2px rgba(0, 0, 0, 0.4), 0px 4px 6px rgba(0, 0, 0, 0.4);
            animation: color-cycle 20s linear infinite;
        }

        @keyframes color-cycle {
            0% { color: var(--text-color); }
            25% { color: var(--glow-color1); }
            50% { color: var(--glow-color2); }
            75% { color: var(--glow-color3); }
            100% { color: var(--text-color); }
        }

        .ayah-number {
            display: inline-block;
            font-size: 1.5rem;
            padding-left: 10px;
            opacity: 0.7;
        }

        .back-button {
            position: fixed;
            top: 20px;
            left: 20px;
            padding: 12px 20px;
            background-color: var(--text-color);
            color: var(--background-color);
            border: none;
            border-radius: 50px;
            font-size: 1.2rem;
            font-weight: bold;
            cursor: pointer;
            z-index: 100;
            box-shadow: 0 5px 15px var(--menu-box-shadow);
            font-family: 'Noto Nastaliq Urdu', sans-serif;
        }

        .audio-player-wrapper {
            position: relative;
            max-width: 550px;
            margin: 0 auto 35px auto;
            padding: 15px;
            border-radius: 20px;
            box-shadow: inset 0 2px 4px var(--menu-box-shadow), 0 10px 20px var(--menu-box-shadow);
            border: 1px solid rgba(255,255,255,0.1);
            animation: box-color-change 18s linear infinite;
        }

        .audio-player-wrapper::before,
        .audio-player-wrapper::after {
            content: '';
            position: absolute;
            top: -2px;
            left: -2px;
            right: -2px;
            bottom: -2px;
            border-radius: 22px;
            z-index: -1;
            filter: blur(25px);
            animation: aura-pulse 8s ease-in-out infinite alternate;
        }

        .audio-player-wrapper::before {
            background: linear-gradient(45deg, var(--glow-color1), var(--glow-color3));
        }

        .audio-player-wrapper::after {
            background: linear-gradient(-45deg, var(--glow-color2), var(--glow-color4));
            animation-delay: -4s;
        }

        .custom-audio-player {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 0 10px;
        }

        .play-pause-btn {
            background: linear-gradient(145deg, rgba(255,255,255,0.2), rgba(255,255,255,0));
            border: 1px solid rgba(255,255,255,0.2);
            border-radius: 50%;
            width: 55px;
            height: 55px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 4px 10px var(--menu-box-shadow);
            transition: transform 0.2s ease, box-shadow 0.2s ease;
            flex-shrink: 0;
        }

        .play-pause-btn:hover {
            transform: scale(1.1);
            box-shadow: 0 6px 15px var(--menu-box-shadow);
        }

        .play-pause-btn svg {
            width: 28px;
            height: 28px;
            filter: drop-shadow(0 0 3px rgba(0,0,0,0.5));
            fill: var(--text-color);
        }

        .progress-container {
            width: 100%;
            height: 8px;
            background-color: rgba(0,0,0,0.3);
            border-radius: 10px;
            cursor: pointer;
            overflow: hidden;
            box-shadow: inset 0 1px 3px var(--menu-box-shadow);
        }

        .progress-bar {
            height: 100%;
            width: 0%;
            border-radius: 10px;
            background: linear-gradient(90deg, var(--glow-color1), var(--glow-color2), var(--glow-color3));
            background-size: 300% 100%;
            animation: gradient-flow 5s linear infinite;
            box-shadow: 0 0 8px var(--glow-color1);
            transition: width 0.1s linear;
        }

        @keyframes gradient-flow {
            0% { background-position: 0% 50%; }
            100% { background-position: 100% 50%; }
        }

        .time-display {
            font-family: monospace;
            font-size: 0.9rem;
            color: var(--text-color);
            text-shadow: 0 1px 2px rgba(0,0,0,0.5);
            text-align: center;
            min-width: 90px;
        }

        /* تھیم سلیکٹر اسٹائلز */
        .theme-selector {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 100;
        }

        .theme-selector select {
            padding: 10px;
            font-family: 'Noto Nastaliq Urdu', sans-serif;
            font-size: 1rem;
            border-radius: 10px;
            background: linear-gradient(145deg, var(--glow-color1), var(--glow-color2));
            color: var(--text-color);
            border: 1px solid rgba(255,255,255,0.2);
            cursor: pointer;
            box-shadow: 0 5px 15px var(--menu-box-shadow);
        }

        .theme-selector select:focus {
            outline: none;
            box-shadow: 0 0 10px var(--highlight-glow);
        }

        @media (max-width: 768px) {
            body {
                padding: 10px;
            }
            #bismillah-text {
                font-size: 2.2rem;
            }
            .home-header h2 {
                font-size: 2rem;
            }
            .menu-title {
                font-size: 1.8rem;
            }
            .header h1 {
                font-size: 2.5rem;
            }
            .ayah-box {
                transform: none;
                padding: 20px;
            }
            .ayah-text {
                font-size: 1.8rem;
            }
            .back-button {
                font-size: 1rem;
                padding: 10px 15px;
            }
            .theme-selector {
                top: 10px;
                right: 10px;
            }
            .theme-selector select {
                font-size: 0.9rem;
                padding: 8px;
            }
        }
    </style>
</head>
<body class="theme-default">
    <div id="homeScreen">
        <div class="theme-selector">
            <select id="theme-select" onchange="changeTheme()">
                <option value="theme-default">پہلے سے طے شدہ</option>
                <option value="theme-midnight-blue">رات کا نیلا</option>
                <option value="theme-emerald-glow">زمردی چمک</option>
                <option value="theme-crimson-dawn">سرخیلی صبح</option>
                <option value="theme-golden-sunset">سنہری غروب</option>
                <option value="theme-amethyst-night">جامنی رات</option>
                <option value="theme-royal-purple">شاہی جامنی</option>
                <option value="theme-ocean-breeze">سمندری ہوا</option>
                <option value="theme-forest-dusk">جنگلی شام</option>
                <option value="theme-rose-blush">گلابی چمک</option>
                <option value="theme-silver-moon">چاندی کا چاند</option>
            </select>
        </div>
        <div class="aura-container">
            <div class="home-header">
                <h2>قرآن شریف</h2>
                <div class="typing-container">
                    <h1 id="bismillah-text">بِسْمِ اللّٰهِ الرَّحْمٰنِ الرَّحِيْمِ</h1>
                </div>
            </div>
        </div>
        <div id="main-menu" class="menu-container"></div>
    </div>

    <div id="surah-pages-container"></div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const homeScreen = document.getElementById('homeScreen');
            const mainMenuContainer = document.getElementById('main-menu');
            const surahPagesContainer = document.getElementById('surah-pages-container');

            const surahNames = [
                "الفاتحہ", "البقرہ", "آل عمران", "النساء", "المائدہ", "الأنعام", "الأعراف", "الأنفال", "التوبہ", "یونس",
                "ہود", "یوسف", "الرعد", "ابراہیم", "الحجر", "النحل", "الإسراء", "الکہف", "مریم", "طہ",
                "الأنبیاء", "الحج", "المؤمنون", "النور", "الفرقان", "الشعراء", "النمل", "القصص", "العنکبوت", "الروم",
                "لقمان", "السجدہ", "الأحزاب", "سبا", "فاطر", "یٰسٓ", "الصافات", "ص", "الزمر", "غافر",
                "فصلت", "الشوریٰ", "الزخرف", "الدخان", "الجاثیہ", "الأحقاف", "محمد", "الفتح", "الحجرات", "ق",
                "الذاریات", "الطور", "النجم", "القمر", "الرحمٰن", "الواقعہ", "الحدید", "المجادلہ", "الحشر", "الممتحنہ",
                "الصف", "الجمعہ", "المنافقون", "التغابن", "الطلاق", "التحریم", "الملک", "القلم", "الحاقہ", "المعارج",
                "نوح", "الجن", "المزمل", "المدثر", "القیامہ", "الإنسان", "المرسلات", "النبأ", "النازعات", "عبس",
                "التکویر", "الإنفطار", "المطففین", "الإنشقاق", "البروج", "الطارق", "الأعلیٰ", "الغاشیہ", "الفجر", "البلد",
                "الشمس", "اللیل", "الضحیٰ", "الشرح", "التین", "العلق", "القدر", "البینہ", "الزلزلہ", "العادیات",
                "القارعہ", "التکاثر", "العصر", "الہمزہ", "الفیل", "قریش", "الماعون", "الکوثر", "الکافرون", "النصر",
                "المسد", "الإخلاص", "الفلق", "الناس"
            ];

            function generateContent() {
                for (let i = 1; i <= 114; i++) {
                    const menuBox = document.createElement('div');
                    menuBox.className = `menu-box menu-box-${(i % 8) + 1}`;
                    menuBox.onclick = () => showPage(`surah${i}Page`);
                    console.log(`Index: ${i-1}, Name: ${surahNames[i-1]}`);
                    menuBox.innerHTML = `<div class="menu-title">سورة ${surahNames[i-1]}</div>`;
                    mainMenuContainer.appendChild(menuBox);

                    const surahPage = document.createElement('div');
                    surahPage.id = `surah${i}Page`;
                    surahPage.className = 'surah-page';
                    const audioSurahNumber = String(i).padStart(3, '0');
                    surahPage.innerHTML = `
                        <button class="back-button" onclick="showHomeScreen()">⇦ ہوم</button>
                        <header class="header">
                            ${i !== 1 && i !== 9 ? '<h1>بِسْمِ اللّٰهِ الرَّحْمٰنِ الرَّحِيْمِ</h1>' : ''}
                            <h1>سورة ${surahNames[i-1]}</h1>
                        </header>
                        <div class="audio-player-wrapper">
                            <div class="custom-audio-player" data-audio-src="https://download.quranicaudio.com/quran/abdul_basit_murattal/${audioSurahNumber}.mp3">
                                <p style="text-align:center; padding: 10px 0;">آڈیو پلیئر لوڈ ہو رہا ہے...</p>
                            </div>
                        </div>
                        <main class="surah-container">
                            <p style="text-align: center;">لوڈ ہو رہا ہے...</p>
                        </main>`;
                    surahPagesContainer.appendChild(surahPage);
                }
            }

            window.showPage = (pageId) => {
                homeScreen.style.display = 'none';
                document.querySelectorAll('.surah-page').forEach(page => page.style.display = 'none');
                const targetPage = document.getElementById(pageId);
                if (targetPage) {
                    targetPage.style.display = 'block';
                    const surahNumber = pageId.replace('surah', '').replace('Page', '');
                    if (!targetPage.dataset.loaded) {
                        loadSurahData(surahNumber, targetPage);
                        targetPage.dataset.loaded = 'true';
                    }
                    const audioPlayerElement = targetPage.querySelector('.custom-audio-player');
                    if (audioPlayerElement && !audioPlayerElement.dataset.initialized) {
                        initializeSingleAudioPlayer(audioPlayerElement);
                    }
                }
            };

            window.showHomeScreen = () => {
                document.querySelectorAll('.surah-page').forEach(page => {
                    page.style.display = 'none';
                    const audio = page.querySelector('audio');
                    if (audio && !audio.paused) {
                        audio.pause();
                    }
                });
                homeScreen.style.display = 'flex';
            };

            async function loadSurahData(surahNumber, pageElement) {
                const container = pageElement.querySelector('.surah-container');
                const cacheKey = `surah_${surahNumber}`;
                try {
                    const cachedData = localStorage.getItem(cacheKey);
                    if (cachedData) {
                        renderSurah(JSON.parse(cachedData), container);
                        return;
                    }
                    const response = await fetch(`https://api.alquran.cloud/v1/surah/${surahNumber}`);
                    if (!response.ok) throw new Error('Network response was not ok.');
                    const data = await response.json();
                    const ayahs = data.data.ayahs;
                    localStorage.setItem(cacheKey, JSON.stringify(ayahs));
                    renderSurah(ayahs, container);
                } catch (error) {
                    console.error('Failed to fetch surah data:', error);
                    container.innerHTML = `<p style="text-align: center; color: var(--glow-color3);">سورة لوڈ کرنے میں ناکامی ہوئی۔ براہ کرم دوبارہ کوشش کریں.</p>`;
                }
            }

            function renderSurah(ayahs, container) {
                let surahHTML = '';
                ayahs.forEach(ayah => {
                    surahHTML += `
                        <div class="ayah-box">
                            <p class="ayah-text">
                                ${ayah.text}
                                <span class="ayah-number">﴿${ayah.numberInSurah}﴾</span>
                            </p>
                        </div>`;
                });
                container.innerHTML = surahHTML;
                setupIntersectionObserver();
            }

            function setupIntersectionObserver() {
                const observer = new IntersectionObserver((entries) => {
                    entries.forEach(entry => {
                        if (entry.isIntersecting) {
                            entry.target.classList.add('visible');
                            observer.unobserve(entry.target);
                        }
                    });
                }, { threshold: 0.1 });
                document.querySelectorAll('.ayah-box:not(.visible)').forEach(box => {
                    observer.observe(box);
                });
            }

            function initializeSingleAudioPlayer(player) {
                const audioSrc = player.dataset.audioSrc;
                if (!audioSrc) return;
                player.dataset.initialized = 'true';
                player.innerHTML = `
                    <button class="play-pause-btn">
                        <svg class="play-icon" viewBox="0 0 24 24"><path d="M8 5v14l11-7z"></path></svg>
                        <svg class="pause-icon" viewBox="0 0 24 24" style="display:none;"><path d="M6 19h4V5H6v14zm8-14v14h4V5h-4z"></path></svg>
                    </button>
                    <div class="progress-container"><div class="progress-bar"></div></div>
                    <div class="time-display">00:00 / 00:00</div>`;

                const audio = new Audio(audioSrc);
                audio.preload = 'metadata';
                const playPauseBtn = player.querySelector('.play-pause-btn');
                const playIcon = player.querySelector('.play-icon');
                const pauseIcon = player.querySelector('.pause-icon');
                const progressContainer = player.querySelector('.progress-container');
                const progressBar = player.querySelector('.progress-bar');
                const timeDisplay = player.querySelector('.time-display');

                playPauseBtn.addEventListener('click', () => {
                    if (audio.paused) audio.play(); else audio.pause();
                });
                audio.addEventListener('play', () => {
                    playIcon.style.display = 'none';
                    pauseIcon.style.display = 'block';
                });
                audio.addEventListener('pause', () => {
                    playIcon.style.display = 'block';
                    pauseIcon.style.display = 'none';
                });

                const formatTime = (s) => `${String(Math.floor(s/60)).padStart(2,'0')}:${String(Math.floor(s%60)).padStart(2,'0')}`;
                audio.addEventListener('loadedmetadata', () => {
                    timeDisplay.textContent = `00:00 / ${formatTime(audio.duration)}`;
                });
                audio.addEventListener('timeupdate', () => {
                    if (audio.duration) {
                        progressBar.style.width = `${(audio.currentTime / audio.duration) * 100}%`;
                        timeDisplay.textContent = `${formatTime(audio.currentTime)} / ${formatTime(audio.duration)}`;
                    }
                });
                progressContainer.addEventListener('click', (e) => {
                    if (audio.duration) audio.currentTime = (e.offsetX / progressContainer.clientWidth) * audio.duration;
                });
                player.closest('.surah-page').appendChild(audio);
                audio.style.display = 'none';
            }

            // تھیم تبدیل کرنے کا فنکشن
            window.changeTheme = () => {
                const select = document.getElementById('theme-select');
                document.body.className = select.value;
                localStorage.setItem('selectedTheme', select.value);
            };

            // محفوظ شدہ تھیم لوڈ کریں
            const savedTheme = localStorage.getItem('selectedTheme') || 'theme-default';
            document.body.className = savedTheme;
            document.getElementById('theme-select').value = savedTheme;

            generateContent();
        });
    </script>
</body>
</html>
